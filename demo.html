<!doctype html>
<html>

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-capable" content="yes">

  <title></title>
  <script src="../webcomponentsjs/webcomponents-lite.js"></script>
  <link rel="import" href="../polymer/polymer.html">
  <link rel="import" href="../layout/layout.html">
  <link rel="import" href="at-form-ruleset.html" />
</head>

<body>
  <div class="vertical layout">
    <div class="horizontal layout">
      <h3>This is a demo for at-form-ruleset</h3>
    </div>
    <div class="horizontal layout">
      <at-form-ruleset id="demoRuleset">
      </at-form-ruleset>
    </div>
  </div>
</body>

<script>
  document.addEventListener('WebComponentsReady', function () {
    var enemyOptions = [
      {
        label: "",
        name: ""
        },
      {
        label: "Enemy1",
        name: "enemy1"
        },
      {
        label: "Enemy2",
        name: "enemy2"
        },
      {
        label: "Enemy3",
        name: "enemy3"
        },
      ];

    var ruleConfig = {
      conditions: [
        {
          label: "Damage",
          name: "damageField",
          operators: [
            {
              label: "is equal to",
              name: "equalTo",
              fieldType: "text"
              },
            {
              label: "is not equal to",
              name: "notEqualTo",
              fieldType: "text"
              },
            ]
          },
        {
          label: "Health",
          name: "healthField",
          operators: [
            {
              label: "is greater than or equal to",
              name: "greaterThanEqual",
              fieldType: "text"
              },
            {
              label: "is less than or equal to",
              name: "lessThanEqual",
              fieldType: "text"
              },
            ]
          },
        {
          label: "Enemy",
          name: "enemyField",
          options: enemyOptions,
          operators: [
            {
              label: "is present",
              name: "present",
              fieldType: "none"
              },
            {
              label: "is blank",
              name: "blank",
              fieldType: "none"
              },
            {
              label: "is equal to",
              name: "equalTo",
              fieldType: "select"
              },
            {
              label: "is not equal to",
              name: "notEqualTo",
              fieldType: "select"
              },
            ]
          }
        ],
      actions: [
        {
          label: "Show Alert",
          name: "alert",
          fields: [
            {
              label: "Message",
              name: "message",
              fieldType: "textarea"
              }
            ]
          },
        {
          label: "Update Field",
          name: "updateField",
          fields: [
            {
              label: "Field",
              name: "fieldId",
              fieldType: "select",
              options: [
                {
                  label: "Damage to",
                  name: "damageField",
                  fields: [
                    {
                      label: "New Value",
                      name: "newValue",
                      fieldType: "text"
                      }
                  ]
                },
                {
                  label: "Health to",
                  name: "healthField",
                  fields: [
                    {
                      label: "New Value",
                      name: "newValue",
                      fieldType: "text"
                      }
                  ]
                },
                {
                  label: "Enemy to",
                  name: "enemyField",
                  fields: [
                    {
                      label: "New Value",
                      name: "newValue",
                      fieldType: "select",
                      options: enemyOptions
                      }
                  ]
                }
               ]
             },
            ]
          }
        ]
    };

    var ruleData = {
      conditions: {
        "all": [
          {
            name: "damageField",
            operator: "equalTo",
            value: "50"
            },
          {
            name: "healthField",
            operator: "lessThanEqual",
            value: "49"
            }
          ]
      },
      actions: [
        {
          name: "action-select",
          value: "alert",
          fields: [
            {
              name: "message",
              value: "You have been ... !"
              }
            ]
          },
        {
          name: "action-select",
          value: "updateField",
          fields: [
            {
              name: "fieldId",
              value: "enemyField",
              fields: [
                {
                  name: "newValue",
                  value: "enemy3"
                  }
               ]
             }
            ]
          }
      ]
    };

    var ruleConfig1 = {
      conditions: [
        {
          label: "Damage",
          name: "damageField",
          operators: [
            {
              label: "is equal to",
              name: "equalTo",
              fieldType: "text"
              },
            {
              label: "is not equal to",
              name: "notEqualTo",
              fieldType: "text"
              },
            ]
          },
        {
          label: "Health",
          name: "healthField",
          operators: [
            {
              label: "is greater than or equal to",
              name: "greaterThanEqual",
              fieldType: "text"
              },
            {
              label: "is less than or equal to",
              name: "lessThanEqual",
              fieldType: "text"
              },
            ]
          },
        {
          label: "Enemy",
          name: "enemyField",
          options: enemyOptions,
          operators: [
            {
              label: "is present",
              name: "present",
              fieldType: "none"
              },
            {
              label: "is blank",
              name: "blank",
              fieldType: "none"
              },
            {
              label: "is equal to",
              name: "equalTo",
              fieldType: "select"
              },
            {
              label: "is not equal to",
              name: "notEqualTo",
              fieldType: "select"
              },
            ]
          }
        ],
      actions: [
        {
          label: "Show Alert",
          name: "alert",
          fields: [
            {
              label: "Message",
              name: "message",
              fieldType: "textarea"
              }
            ]
          },
        {
          label: "Update Field",
          name: "updateField",
          fields: [
            {
              label: "Field",
              name: "fieldId",
              fieldType: "select",
              options: [
                {
                  label: "Damage to",
                  name: "damageField",
                  fields: [
                    {
                      label: "New Value",
                      name: "newValue",
                      fieldType: "text"
                      }
                  ]
                },
                {
                  label: "Health to",
                  name: "healthField",
                  fields: [
                    {
                      label: "New Value",
                      name: "newValue",
                      fieldType: "text"
                      }
                  ]
                },
                {
                  label: "Enemy to",
                  name: "enemyField",
                  fields: [
                    {
                      label: "New Value",
                      name: "newValue",
                      fieldType: "select",
                      options: enemyOptions
                      }
                  ]
                }
               ]
             },
            ]
          }
        ]
    };

    var ruleData1 = {
      conditions: {
        "all": [
          {
            name: "damageField",
            operator: "equalTo",
            value: "50"
            },
          {
            name: "healthField",
            operator: "lessThanEqual",
            value: "49"
            }
          ]
      },
      actions: [
        {
          name: "action-select",
          value: "alert",
          fields: [
            {
              name: "message",
              value: "You have been ... !"
              }
            ]
          },
        {
          name: "action-select",
          value: "updateField",
          fields: [
            {
              name: "fieldId",
              value: "enemyField",
              fields: [
                {
                  name: "newValue",
                  value: "enemy3"
                  }
               ]
             }
            ]
          }
      ]
    };
    
    var ruleset = [
      {
        caption: "Mwahahaha!",
        position: 0,
        rule: {
          config: ruleConfig,
          value: ruleData
        }
      }, {
        caption: "Bwahahaha!",
        position: 1,
        rule: {
          config: ruleConfig1,
          value: ruleData1
        }
      }
    ];

    var demoRuleset = document.getElementById('demoRuleset');
    demoRuleset.value = ruleset;
    
    window.djuraMika = demoRuleset.value;
  });
</script>

</html>